<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="onewire__bus__impl__rmt_8c" kind="file" language="C++">
    <compoundname>onewire_bus_impl_rmt.c</compoundname>
    <includes local="no">string.h</includes>
    <includes local="yes">freertos/FreeRTOS.h</includes>
    <includes local="yes">freertos/task.h</includes>
    <includes local="yes">freertos/queue.h</includes>
    <includes local="yes">freertos/semphr.h</includes>
    <includes local="yes">esp_check.h</includes>
    <includes local="yes">esp_attr.h</includes>
    <includes local="yes">driver/rmt_tx.h</includes>
    <includes local="yes">driver/rmt_rx.h</includes>
    <includes refid="onewire__bus__impl__rmt_8h" local="yes">onewire_bus_impl_rmt.h</includes>
    <includes refid="onewire__bus__interface_8h" local="yes">onewire_bus_interface.h</includes>
    <incdepgraph>
      <node id="11">
        <label>onewire_bus_impl_rmt.h</label>
        <link refid="onewire__bus__impl__rmt_8h_source"/>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>onewire_types.h</label>
        <link refid="onewire__types_8h_source"/>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="15">
        <label>onewire_bus_interface.h</label>
        <link refid="onewire__bus__interface_8h_source"/>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c</label>
        <link refid="onewire__bus__impl__rmt_8c"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>driver/rmt_rx.h</label>
      </node>
      <node id="9">
        <label>driver/rmt_tx.h</label>
      </node>
      <node id="8">
        <label>esp_attr.h</label>
      </node>
      <node id="7">
        <label>esp_check.h</label>
      </node>
      <node id="13">
        <label>esp_err.h</label>
      </node>
      <node id="3">
        <label>freertos/FreeRTOS.h</label>
      </node>
      <node id="5">
        <label>freertos/queue.h</label>
      </node>
      <node id="6">
        <label>freertos/semphr.h</label>
      </node>
      <node id="4">
        <label>freertos/task.h</label>
      </node>
      <node id="12">
        <label>stdint.h</label>
      </node>
      <node id="2">
        <label>string.h</label>
      </node>
    </incdepgraph>
    <innerclass refid="structonewire__bus__rmt__obj__t" prot="public">onewire_bus_rmt_obj_t</innerclass>
    <sectiondef kind="define">
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1a0ca47b8be20ff83bf1d16847b130bf73" prot="public" static="no">
        <name>ONEWIRE_RMT_RESOLUTION_HZ</name>
        <initializer>1000000</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="20" column="9" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="20" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1ab987d80642b86821547cbad320a35644" prot="public" static="no">
        <name>ONEWIRE_RMT_DEFAULT_TRANS_QUEUE_SIZE</name>
        <initializer>4</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="21" column="9" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="21" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1a8ddeb05b41b9c2def13c8542a6f28846" prot="public" static="no">
        <name>ONEWIRE_RMT_DEFAULT_MEM_BLOCK_SYMBOLS</name>
        <initializer>48</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="27" column="10" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="27" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1a3954f58f1095120f151d46b7d0bb4ed5" prot="public" static="no">
        <name>ONEWIRE_RMT_RX_MEM_BLOCK_SIZE</name>
        <initializer>ONEWIRE_RMT_DEFAULT_MEM_BLOCK_SYMBOLS</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="35" column="9" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="35" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1a5a1d34eaf3fe5ed19e8fd96a60bfc09c" prot="public" static="no">
        <name>ONEWIRE_RESET_PULSE_DURATION</name>
        <initializer>500</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="53" column="9" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="53" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1a5719169f22dd74146488af1ad05fe62c" prot="public" static="no">
        <name>ONEWIRE_RESET_WAIT_DURATION</name>
        <initializer>200</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="54" column="9" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="54" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1add6f9ed230b4bd72b7dc7d0ef56e8d85" prot="public" static="no">
        <name>ONEWIRE_RESET_PRESENCE_WAIT_DURATION_MIN</name>
        <initializer>15</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="55" column="9" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="55" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1a24f97af90558dba13970800af52c2ce3" prot="public" static="no">
        <name>ONEWIRE_RESET_PRESENCE_DURATION_MIN</name>
        <initializer>60</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="56" column="9" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="56" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1abbc6302d7e4accaa99a382ca2a165692" prot="public" static="no">
        <name>ONEWIRE_SLOT_START_DURATION</name>
        <initializer>2</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="106" column="9" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="106" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1ae7423f50d948a2d3a1d09b176e35a28c" prot="public" static="no">
        <name>ONEWIRE_SLOT_BIT_DURATION</name>
        <initializer>60</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="107" column="9" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="107" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1aeea814faca217319548d941ac05608e7" prot="public" static="no">
        <name>ONEWIRE_SLOT_RECOVERY_DURATION</name>
        <initializer>5</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="109" column="9" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="109" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="onewire__bus__impl__rmt_8c_1a003a4eedc436b2dc9bbee9220a702a21" prot="public" static="no">
        <name>ONEWIRE_SLOT_BIT_SAMPLE_TIME</name>
        <initializer>15</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="110" column="9" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="110" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="var">
      <memberdef kind="variable" id="onewire__bus__impl__rmt_8c_1a5a85b9c772bbeb480b209a3e6ea92b4c" prot="public" static="yes" mutable="no">
        <type>const char *</type>
        <definition>const char* TAG</definition>
        <argsstring></argsstring>
        <name>TAG</name>
        <initializer>= &quot;1-wire.rmt&quot;</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="18" column="19" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="18" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="onewire__bus__impl__rmt_8c_1a43a9ab22302d88d41824d75c69b517c1" prot="public" static="yes" mutable="no">
        <type>rmt_symbol_word_t</type>
        <definition>rmt_symbol_word_t onewire_reset_pulse_symbol</definition>
        <argsstring></argsstring>
        <name>onewire_reset_pulse_symbol</name>
        <initializer>= {
    .level0 = 0,
    .duration0 = ONEWIRE_RESET_PULSE_DURATION,
    .level1 = 1,
    .duration1 = ONEWIRE_RESET_WAIT_DURATION
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="128" column="26" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="128" bodyend="133"/>
      </memberdef>
      <memberdef kind="variable" id="onewire__bus__impl__rmt_8c_1a16d634de60323adf1e89bdb779d334b0" prot="public" static="yes" mutable="no">
        <type>rmt_symbol_word_t</type>
        <definition>rmt_symbol_word_t onewire_bit0_symbol</definition>
        <argsstring></argsstring>
        <name>onewire_bit0_symbol</name>
        <initializer>= {
    .level0 = 0,
    .duration0 = ONEWIRE_SLOT_START_DURATION + ONEWIRE_SLOT_BIT_DURATION,
    .level1 = 1,
    .duration1 = ONEWIRE_SLOT_RECOVERY_DURATION
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="135" column="26" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="135" bodyend="140"/>
      </memberdef>
      <memberdef kind="variable" id="onewire__bus__impl__rmt_8c_1a219f9c0431a3b0eabbc3d3a6e0be249b" prot="public" static="yes" mutable="no">
        <type>rmt_symbol_word_t</type>
        <definition>rmt_symbol_word_t onewire_bit1_symbol</definition>
        <argsstring></argsstring>
        <name>onewire_bit1_symbol</name>
        <initializer>= {
    .level0 = 0,
    .duration0 = ONEWIRE_SLOT_START_DURATION,
    .level1 = 1,
    .duration1 = ONEWIRE_SLOT_BIT_DURATION + ONEWIRE_SLOT_RECOVERY_DURATION
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="142" column="26" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="142" bodyend="147"/>
      </memberdef>
      <memberdef kind="variable" id="onewire__bus__impl__rmt_8c_1a28960149b4c643056fdce6a94cfd5a82" prot="public" static="yes" mutable="no">
        <type>const rmt_transmit_config_t</type>
        <definition>const rmt_transmit_config_t onewire_rmt_tx_config</definition>
        <argsstring></argsstring>
        <name>onewire_rmt_tx_config</name>
        <initializer>= {
    .loop_count = 0,     
    .flags.eot_level = 1 
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="149" column="36" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="149" bodyend="152"/>
      </memberdef>
      <memberdef kind="variable" id="onewire__bus__impl__rmt_8c_1a647660dc4061a885760126ada46698db" prot="public" static="yes" mutable="no">
        <type>const rmt_receive_config_t</type>
        <definition>const rmt_receive_config_t onewire_rmt_rx_config</definition>
        <argsstring></argsstring>
        <name>onewire_rmt_rx_config</name>
        <initializer>= {
    .signal_range_min_ns = 1000000000 / ONEWIRE_RMT_RESOLUTION_HZ,
    .signal_range_max_ns = (ONEWIRE_RESET_PULSE_DURATION + ONEWIRE_RESET_WAIT_DURATION) * 1000,
}</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="154" column="35" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="154" bodyend="157"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="onewire__bus__impl__rmt_8c_1ad914c8a5a2d09a14733872a03c1d30f7" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>esp_err_t</type>
        <definition>static esp_err_t onewire_bus_rmt_read_bit</definition>
        <argsstring>(onewire_bus_handle_t bus, uint8_t *rx_bit)</argsstring>
        <name>onewire_bus_rmt_read_bit</name>
        <param>
          <type><ref refid="structonewire__bus__t" kindref="compound">onewire_bus_handle_t</ref></type>
          <declname>bus</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>rx_bit</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="471" column="18" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="471" bodyend="495" declfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" declline="159" declcolumn="18"/>
      </memberdef>
      <memberdef kind="function" id="onewire__bus__impl__rmt_8c_1a78122f9ac3c0525d50083d4acd65e369" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>esp_err_t</type>
        <definition>static esp_err_t onewire_bus_rmt_write_bit</definition>
        <argsstring>(onewire_bus_handle_t bus, uint8_t tx_bit)</argsstring>
        <name>onewire_bus_rmt_write_bit</name>
        <param>
          <type><ref refid="structonewire__bus__t" kindref="compound">onewire_bus_handle_t</ref></type>
          <declname>bus</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>tx_bit</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="452" column="18" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="452" bodyend="469" declfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" declline="160" declcolumn="18"/>
      </memberdef>
      <memberdef kind="function" id="onewire__bus__impl__rmt_8c_1ab12bebaccea089497998dc480cc6d673" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>esp_err_t</type>
        <definition>static esp_err_t onewire_bus_rmt_read_bytes</definition>
        <argsstring>(onewire_bus_handle_t bus, uint8_t *rx_buf, size_t rx_buf_size)</argsstring>
        <name>onewire_bus_rmt_read_bytes</name>
        <param>
          <type><ref refid="structonewire__bus__t" kindref="compound">onewire_bus_handle_t</ref></type>
          <declname>bus</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>rx_buf</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>rx_buf_size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="423" column="18" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="423" bodyend="450" declfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" declline="161" declcolumn="18"/>
      </memberdef>
      <memberdef kind="function" id="onewire__bus__impl__rmt_8c_1a53c037eb2a9813e8b540dacb779c9cb1" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>esp_err_t</type>
        <definition>static esp_err_t onewire_bus_rmt_write_bytes</definition>
        <argsstring>(onewire_bus_handle_t bus, const uint8_t *tx_data, uint8_t tx_data_size)</argsstring>
        <name>onewire_bus_rmt_write_bytes</name>
        <param>
          <type><ref refid="structonewire__bus__t" kindref="compound">onewire_bus_handle_t</ref></type>
          <declname>bus</declname>
        </param>
        <param>
          <type>const uint8_t *</type>
          <declname>tx_data</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>tx_data_size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="404" column="18" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="404" bodyend="419" declfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" declline="162" declcolumn="18"/>
      </memberdef>
      <memberdef kind="function" id="onewire__bus__impl__rmt_8c_1a78474dd2fd1656152e6af7e3f27a0390" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>esp_err_t</type>
        <definition>static esp_err_t onewire_bus_rmt_reset</definition>
        <argsstring>(onewire_bus_handle_t bus)</argsstring>
        <name>onewire_bus_rmt_reset</name>
        <param>
          <type><ref refid="structonewire__bus__t" kindref="compound">onewire_bus_handle_t</ref></type>
          <declname>bus</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="379" column="18" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="379" bodyend="402" declfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" declline="163" declcolumn="18"/>
      </memberdef>
      <memberdef kind="function" id="onewire__bus__impl__rmt_8c_1a4673ad12b3c64976016f66dfecdb750c" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>esp_err_t</type>
        <definition>static esp_err_t onewire_bus_rmt_del</definition>
        <argsstring>(onewire_bus_handle_t bus)</argsstring>
        <name>onewire_bus_rmt_del</name>
        <param>
          <type><ref refid="structonewire__bus__t" kindref="compound">onewire_bus_handle_t</ref></type>
          <declname>bus</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="373" column="18" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="373" bodyend="377" declfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" declline="164" declcolumn="18"/>
      </memberdef>
      <memberdef kind="function" id="onewire__bus__impl__rmt_8c_1a34b2e7f53213fd40aba6bd4b7d8ae50f" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>esp_err_t</type>
        <definition>static esp_err_t onewire_bus_rmt_destroy</definition>
        <argsstring>(onewire_bus_rmt_obj_t *bus_rmt)</argsstring>
        <name>onewire_bus_rmt_destroy</name>
        <param>
          <type><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref> *</type>
          <declname>bus_rmt</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="344" column="18" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="344" bodyend="371" declfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" declline="165" declcolumn="18"/>
      </memberdef>
      <memberdef kind="function" id="onewire__bus__impl__rmt_8c_1a48a7c0b91948e7dd664bc684df644f75" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>IRAM_ATTR bool</type>
        <definition>IRAM_ATTR bool onewire_rmt_rx_done_callback</definition>
        <argsstring>(rmt_channel_handle_t channel, const rmt_rx_done_event_data_t *edata, void *user_data)</argsstring>
        <name>onewire_rmt_rx_done_callback</name>
        <param>
          <type>rmt_channel_handle_t</type>
          <declname>channel</declname>
        </param>
        <param>
          <type>const rmt_rx_done_event_data_t *</type>
          <declname>edata</declname>
        </param>
        <param>
          <type>void *</type>
          <declname>user_data</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="168" column="6" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="168" bodyend="176"/>
      </memberdef>
      <memberdef kind="function" id="onewire__bus__impl__rmt_8c_1aeee8c3757f1f12a80e497b5744ecad16" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>bool</type>
        <definition>static bool onewire_rmt_check_presence_pulse</definition>
        <argsstring>(rmt_symbol_word_t *rmt_symbols, size_t symbol_num)</argsstring>
        <name>onewire_rmt_check_presence_pulse</name>
        <param>
          <type>rmt_symbol_word_t *</type>
          <declname>rmt_symbols</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>symbol_num</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="208" column="13" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="208" bodyend="225"/>
      </memberdef>
      <memberdef kind="function" id="onewire__bus__impl__rmt_8c_1aaff0f11bfb79dc679b01a5fb738e1220" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void onewire_rmt_decode_data</definition>
        <argsstring>(rmt_symbol_word_t *rmt_symbols, size_t symbol_num, uint8_t *rx_buf, size_t rx_buf_size)</argsstring>
        <name>onewire_rmt_decode_data</name>
        <param>
          <type>rmt_symbol_word_t *</type>
          <declname>rmt_symbols</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>symbol_num</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>rx_buf</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>rx_buf_size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="227" column="13" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="227" bodyend="246"/>
      </memberdef>
      <memberdef kind="function" id="onewire__bus__impl__rmt_8c_1a07591c3df6ef26728e657b6d38b052f4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>esp_err_t</type>
        <definition>esp_err_t onewire_new_bus_rmt</definition>
        <argsstring>(const onewire_bus_config_t *bus_config, const onewire_bus_rmt_config_t *rmt_config, onewire_bus_handle_t *ret_bus)</argsstring>
        <name>onewire_new_bus_rmt</name>
        <param>
          <type>const <ref refid="structonewire__bus__config__t" kindref="compound">onewire_bus_config_t</ref> *</type>
          <declname>bus_config</declname>
        </param>
        <param>
          <type>const <ref refid="structonewire__bus__rmt__config__t" kindref="compound">onewire_bus_rmt_config_t</ref> *</type>
          <declname>rmt_config</declname>
        </param>
        <param>
          <type><ref refid="structonewire__bus__t" kindref="compound">onewire_bus_handle_t</ref> *</type>
          <declname>ret_bus</declname>
        </param>
        <briefdescription>
<para>Create 1-Wire bus with RMT backend. </para>
        </briefdescription>
        <detaileddescription>
<para><simplesect kind="note"><para>One 1-Wire bus utilizes a pair of RMT TX and RX channels</para>
</simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">bus_config</parametername>
</parameternamelist>
<parameterdescription>
<para>1-Wire bus configuration </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">rmt_config</parametername>
</parameternamelist>
<parameterdescription>
<para>RMT specific configuration </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">ret_bus</parametername>
</parameternamelist>
<parameterdescription>
<para>Returned 1-Wire bus handle </para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para><itemizedlist>
<listitem><para>ESP_OK: create 1-Wire bus handle successfully</para>
</listitem><listitem><para>ESP_ERR_INVALID_ARG: create 1-Wire bus handle failed because of invalid argument</para>
</listitem><listitem><para>ESP_ERR_NO_MEM: create 1-Wire bus handle failed because of out of memory</para>
</listitem><listitem><para>ESP_FAIL: create 1-Wire bus handle failed because some other error </para>
</listitem></itemizedlist>
</para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" line="248" column="11" bodyfile="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c" bodystart="248" bodyend="342"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>SPDX-FileCopyrightText:<sp/>2022-2023<sp/>Espressif<sp/>Systems<sp/>(Shanghai)<sp/>CO<sp/>LTD</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>SPDX-License-Identifier:<sp/>Apache-2.0</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;freertos/FreeRTOS.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;freertos/task.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;freertos/queue.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;freertos/semphr.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;esp_check.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;esp_attr.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;driver/rmt_tx.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;driver/rmt_rx.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;onewire_bus_impl_rmt.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;onewire_bus_interface.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*TAG<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;1-wire.rmt&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_RMT_RESOLUTION_HZ<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1000000<sp/></highlight><highlight class="comment">//<sp/>RMT<sp/>channel<sp/>default<sp/>resolution<sp/>for<sp/>1-wire<sp/>bus,<sp/>1MHz,<sp/>1tick<sp/>=<sp/>1us</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_RMT_DEFAULT_TRANS_QUEUE_SIZE<sp/><sp/><sp/><sp/>4</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="comment">//<sp/>the<sp/>memory<sp/>size<sp/>of<sp/>each<sp/>RMT<sp/>channel,<sp/>in<sp/>words<sp/>(4<sp/>bytes)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>CONFIG_IDF_TARGET_ESP32<sp/>||<sp/>CONFIG_IDF_TARGET_ESP32S2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_RMT_DEFAULT_MEM_BLOCK_SYMBOLS<sp/><sp/><sp/>64</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_RMT_DEFAULT_MEM_BLOCK_SYMBOLS<sp/><sp/><sp/>48</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="comment">//<sp/>for<sp/>chips<sp/>whose<sp/>RMT<sp/>RX<sp/>channel<sp/>doesn&apos;t<sp/>support<sp/>ping-pong,<sp/>we<sp/>need<sp/>the<sp/>user<sp/>to<sp/>tell<sp/>the<sp/>maximum<sp/>number<sp/>of<sp/>bytes<sp/>will<sp/>be<sp/>received</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>CONFIG_IDF_TARGET_ESP32<sp/>||<sp/>CONFIG_IDF_TARGET_ESP32S2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="comment">//<sp/>one<sp/>RMT<sp/>symbol<sp/>represents<sp/>one<sp/>bit,<sp/>so<sp/>x8</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_RMT_RX_MEM_BLOCK_SIZE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(rmt_config-&gt;max_rx_bytes<sp/>*<sp/>8)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="preprocessor">#else<sp/></highlight><highlight class="comment">//<sp/>otherwise,<sp/>we<sp/>just<sp/>use<sp/>one<sp/>memory<sp/>block,<sp/>to<sp/>save<sp/>resources</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_RMT_RX_MEM_BLOCK_SIZE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ONEWIRE_RMT_DEFAULT_MEM_BLOCK_SYMBOLS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="39"><highlight class="comment">Reset<sp/>Pulse:</highlight></codeline>
<codeline lineno="40"><highlight class="comment"></highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>RESET_PULSE<sp/>|<sp/>RESET_WAIT_DURATION<sp/>|</highlight></codeline>
<codeline lineno="42"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>_DURATION<sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="43"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/>|<sp/>|<sp/>RESET<sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>*<sp/>|<sp/>|<sp/>_PRESENCE<sp/>|<sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/>|<sp/>|<sp/>_DURATION<sp/>|<sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="46"><highlight class="comment">----------+<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+-----+<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+--------------</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="49"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+-------------+<sp/><sp/><sp/><sp/><sp/>+-----------+</highlight></codeline>
<codeline lineno="51"><highlight class="comment">*:<sp/>RESET_PRESENCE_WAIT_DURATION</highlight></codeline>
<codeline lineno="52"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_RESET_PULSE_DURATION<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>500<sp/></highlight><highlight class="comment">//<sp/>duration<sp/>of<sp/>reset<sp/>bit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_RESET_WAIT_DURATION<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>200<sp/></highlight><highlight class="comment">//<sp/>how<sp/>long<sp/>should<sp/>master<sp/>wait<sp/>for<sp/>device<sp/>to<sp/>show<sp/>its<sp/>presence</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_RESET_PRESENCE_WAIT_DURATION_MIN<sp/>15<sp/></highlight><highlight class="comment">//<sp/>minimum<sp/>duration<sp/>for<sp/>master<sp/>to<sp/>wait<sp/>device<sp/>to<sp/>show<sp/>its<sp/>presence</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_RESET_PRESENCE_DURATION_MIN<sp/><sp/><sp/><sp/><sp/><sp/>60<sp/></highlight><highlight class="comment">//<sp/>minimum<sp/>duration<sp/>for<sp/>master<sp/>to<sp/>recognize<sp/>device<sp/>as<sp/>present</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="59"><highlight class="comment">Write<sp/>1<sp/>bit:</highlight></codeline>
<codeline lineno="60"><highlight class="comment"></highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>SLOT_START<sp/>|<sp/>SLOT_BIT<sp/><sp/>|<sp/>SLOT_RECOVERY<sp/>|<sp/>NEXT</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>_DURATION<sp/><sp/>|<sp/>_DURATION<sp/>|<sp/>_DURATION<sp/><sp/><sp/><sp/><sp/>|<sp/>SLOT</highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="64"><highlight class="comment">----------+<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+-------------------------------------</highlight></codeline>
<codeline lineno="65"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="66"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="67"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="68"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+------------+</highlight></codeline>
<codeline lineno="69"><highlight class="comment"></highlight></codeline>
<codeline lineno="70"><highlight class="comment">Write<sp/>0<sp/>bit:</highlight></codeline>
<codeline lineno="71"><highlight class="comment"></highlight></codeline>
<codeline lineno="72"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>SLOT_START<sp/>|<sp/>SLOT_BIT<sp/><sp/>|<sp/>SLOT_RECOVERY<sp/>|<sp/>NEXT</highlight></codeline>
<codeline lineno="73"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>_DURATION<sp/><sp/>|<sp/>_DURATION<sp/>|<sp/>_DURATION<sp/><sp/><sp/><sp/><sp/>|<sp/>SLOT</highlight></codeline>
<codeline lineno="74"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="75"><highlight class="comment">----------+<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+-------------------------</highlight></codeline>
<codeline lineno="76"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="77"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="78"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+------------------------+</highlight></codeline>
<codeline lineno="80"><highlight class="comment"></highlight></codeline>
<codeline lineno="81"><highlight class="comment">Read<sp/>1<sp/>bit:</highlight></codeline>
<codeline lineno="82"><highlight class="comment"></highlight></codeline>
<codeline lineno="83"><highlight class="comment"></highlight></codeline>
<codeline lineno="84"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>SLOT_START<sp/>|<sp/>SLOT_BIT_DURATION<sp/>|<sp/>SLOT_RECOVERY<sp/>|<sp/>NEXT</highlight></codeline>
<codeline lineno="85"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>_DURATION<sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>_DURATION<sp/><sp/><sp/><sp/><sp/>|<sp/>SLOT</highlight></codeline>
<codeline lineno="86"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>SLOT_BIT_<sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="87"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>SAMPLE_TIME<sp/>|<sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="88"><highlight class="comment">----------+<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+----------------------------------------------</highlight></codeline>
<codeline lineno="89"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="90"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="91"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="92"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+------------+</highlight></codeline>
<codeline lineno="93"><highlight class="comment"></highlight></codeline>
<codeline lineno="94"><highlight class="comment">Read<sp/>0<sp/>bit:</highlight></codeline>
<codeline lineno="95"><highlight class="comment"></highlight></codeline>
<codeline lineno="96"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>SLOT_START<sp/>|<sp/>SLOT_BIT_DURATION<sp/>|<sp/>SLOT_RECOVERY<sp/>|<sp/>NEXT</highlight></codeline>
<codeline lineno="97"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>_DURATION<sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>_DURATION<sp/><sp/><sp/><sp/><sp/>|<sp/>SLOT</highlight></codeline>
<codeline lineno="98"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>SLOT_BIT_<sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="99"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>SAMPLE_TIME<sp/>|<sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="100"><highlight class="comment">----------+<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/>+-----------------------------</highlight></codeline>
<codeline lineno="101"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="102"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/>PULLED<sp/>DOWN<sp/><sp/>|</highlight></codeline>
<codeline lineno="103"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/>BY<sp/>DEVICE<sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="104"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+-----------------------------+</highlight></codeline>
<codeline lineno="105"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_SLOT_START_DURATION<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2<sp/><sp/></highlight><highlight class="comment">//<sp/>bit<sp/>start<sp/>pulse<sp/>duration</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_SLOT_BIT_DURATION<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>60<sp/></highlight><highlight class="comment">//<sp/>duration<sp/>for<sp/>each<sp/>bit<sp/>to<sp/>transmit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight><highlight class="comment">//<sp/>refer<sp/>to<sp/>https://www.maximintegrated.com/en/design/technical-documents/app-notes/3/3829.html<sp/>for<sp/>more<sp/>information</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_SLOT_RECOVERY_DURATION<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>5<sp/><sp/></highlight><highlight class="comment">//<sp/>recovery<sp/>time<sp/>between<sp/>each<sp/>bit,<sp/>should<sp/>be<sp/>longer<sp/>in<sp/>parasite<sp/>power<sp/>mode</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ONEWIRE_SLOT_BIT_SAMPLE_TIME<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>15<sp/></highlight><highlight class="comment">//<sp/>how<sp/>long<sp/>after<sp/>bit<sp/>start<sp/>pulse<sp/>should<sp/>the<sp/>master<sp/>sample<sp/>from<sp/>the<sp/>bus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112" refid="structonewire__bus__rmt__obj__t" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structonewire__bus__t" kindref="compound">onewire_bus_t</ref><sp/><ref refid="structonewire__bus__rmt__obj__t_1a070111cd9158e2c0f04daef399273ec7" kindref="member">base</ref>;<sp/></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_channel_handle_t<sp/><ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>;<sp/></highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_channel_handle_t<sp/><ref refid="structonewire__bus__rmt__obj__t_1a2f8d7d9ee9961d32488437ac13803e97" kindref="member">rx_channel</ref>;<sp/></highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_encoder_handle_t<sp/><ref refid="structonewire__bus__rmt__obj__t_1ab0dd9ba8fccbd283fd2619ed30baef58" kindref="member">tx_bytes_encoder</ref>;<sp/></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_encoder_handle_t<sp/><ref refid="structonewire__bus__rmt__obj__t_1af4b1182c1201c65760117aa4e91c8c4b" kindref="member">tx_copy_encoder</ref>;<sp/></highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_symbol_word_t<sp/>*<ref refid="structonewire__bus__rmt__obj__t_1a9a3b01cc4f904f5f7d98e8876a6ac784" kindref="member">rx_symbols_buf</ref>;<sp/></highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="structonewire__bus__rmt__obj__t_1ae2168be4d710c2edecbf3f91502a6f82" kindref="member">max_rx_bytes</ref>;<sp/></highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/>QueueHandle_t<sp/>receive_queue;</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/>SemaphoreHandle_t<sp/>bus_mutex;</highlight></codeline>
<codeline lineno="126"><highlight class="normal">}<sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref>;</highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>rmt_symbol_word_t<sp/>onewire_reset_pulse_symbol<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/>.level0<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/>.duration0<sp/>=<sp/>ONEWIRE_RESET_PULSE_DURATION,</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/>.level1<sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/>.duration1<sp/>=<sp/>ONEWIRE_RESET_WAIT_DURATION</highlight></codeline>
<codeline lineno="133"><highlight class="normal">};</highlight></codeline>
<codeline lineno="134"><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>rmt_symbol_word_t<sp/>onewire_bit0_symbol<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>.level0<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/>.duration0<sp/>=<sp/>ONEWIRE_SLOT_START_DURATION<sp/>+<sp/>ONEWIRE_SLOT_BIT_DURATION,</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/>.level1<sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>.duration1<sp/>=<sp/>ONEWIRE_SLOT_RECOVERY_DURATION</highlight></codeline>
<codeline lineno="140"><highlight class="normal">};</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>rmt_symbol_word_t<sp/>onewire_bit1_symbol<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/>.level0<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/>.duration0<sp/>=<sp/>ONEWIRE_SLOT_START_DURATION,</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/>.level1<sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/>.duration1<sp/>=<sp/>ONEWIRE_SLOT_BIT_DURATION<sp/>+<sp/>ONEWIRE_SLOT_RECOVERY_DURATION</highlight></codeline>
<codeline lineno="147"><highlight class="normal">};</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>rmt_transmit_config_t<sp/>onewire_rmt_tx_config<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/>.loop_count<sp/>=<sp/>0,<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>no<sp/>transfer<sp/>loop</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/>.flags.eot_level<sp/>=<sp/>1<sp/></highlight><highlight class="comment">//<sp/>onewire<sp/>bus<sp/>should<sp/>be<sp/>released<sp/>in<sp/>IDLE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="152"><highlight class="normal">};</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>rmt_receive_config_t<sp/>onewire_rmt_rx_config<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/>.signal_range_min_ns<sp/>=<sp/>1000000000<sp/>/<sp/>ONEWIRE_RMT_RESOLUTION_HZ,</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>.signal_range_max_ns<sp/>=<sp/>(ONEWIRE_RESET_PULSE_DURATION<sp/>+<sp/>ONEWIRE_RESET_WAIT_DURATION)<sp/>*<sp/>1000,</highlight></codeline>
<codeline lineno="157"><highlight class="normal">};</highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_read_bit(onewire_bus_handle_t<sp/>bus,<sp/>uint8_t<sp/>*rx_bit);</highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_write_bit(onewire_bus_handle_t<sp/>bus,<sp/>uint8_t<sp/>tx_bit);</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_read_bytes(onewire_bus_handle_t<sp/>bus,<sp/>uint8_t<sp/>*rx_buf,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>rx_buf_size);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_write_bytes(onewire_bus_handle_t<sp/>bus,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*tx_data,<sp/>uint8_t<sp/>tx_data_size);</highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_reset(onewire_bus_handle_t<sp/>bus);</highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_del(onewire_bus_handle_t<sp/>bus);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_destroy(<ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref><sp/>*bus_rmt);</highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal">IRAM_ATTR</highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>onewire_rmt_rx_done_callback(rmt_channel_handle_t<sp/>channel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>rmt_rx_done_event_data_t<sp/>*edata,<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*user_data)</highlight></codeline>
<codeline lineno="169"><highlight class="normal">{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/>BaseType_t<sp/>task_woken<sp/>=<sp/>pdFALSE;</highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref><sp/>*bus_rmt<sp/>=<sp/>(<ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref><sp/>*)user_data;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/>xQueueSendFromISR(bus_rmt-&gt;receive_queue,<sp/>edata,<sp/>&amp;task_woken);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>task_woken;</highlight></codeline>
<codeline lineno="176"><highlight class="normal">}</highlight></codeline>
<codeline lineno="177"><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="179"><highlight class="comment">[0].0<sp/>means<sp/>symbol[0].duration0</highlight></codeline>
<codeline lineno="180"><highlight class="comment"></highlight></codeline>
<codeline lineno="181"><highlight class="comment">First<sp/>reset<sp/>pulse<sp/>after<sp/>rmt<sp/>channel<sp/>init:</highlight></codeline>
<codeline lineno="182"><highlight class="comment"></highlight></codeline>
<codeline lineno="183"><highlight class="comment">Bus<sp/>is<sp/>low<sp/>|<sp/>Reset<sp/>|<sp/>Wait<sp/>|<sp/><sp/>Device<sp/><sp/>|<sp/><sp/>Bus<sp/>Idle</highlight></codeline>
<codeline lineno="184"><highlight class="comment">after<sp/>init<sp/>|<sp/>Pulse<sp/>|<sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>Presence<sp/>|</highlight></codeline>
<codeline lineno="185"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+------+<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+-----------</highlight></codeline>
<codeline lineno="186"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="187"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="188"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="189"><highlight class="comment">-------------------+<sp/><sp/><sp/><sp/><sp/><sp/>+----------+</highlight></codeline>
<codeline lineno="190"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1<sp/><sp/><sp/><sp/><sp/><sp/>2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>3</highlight></codeline>
<codeline lineno="191"><highlight class="comment"></highlight></codeline>
<codeline lineno="192"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0].1<sp/><sp/><sp/><sp/><sp/>[0].0<sp/><sp/><sp/><sp/><sp/>[1].1<sp/><sp/><sp/><sp/><sp/>[1].0</highlight></codeline>
<codeline lineno="193"><highlight class="comment"></highlight></codeline>
<codeline lineno="194"><highlight class="comment"></highlight></codeline>
<codeline lineno="195"><highlight class="comment">Following<sp/>reset<sp/>pulses:</highlight></codeline>
<codeline lineno="196"><highlight class="comment"></highlight></codeline>
<codeline lineno="197"><highlight class="comment">Bus<sp/>is<sp/>high<sp/>|<sp/>Reset<sp/>|<sp/>Wait<sp/>|<sp/><sp/>Device<sp/><sp/>|<sp/><sp/>Bus<sp/>Idle</highlight></codeline>
<codeline lineno="198"><highlight class="comment">after<sp/>init<sp/><sp/>|<sp/>Pulse<sp/>|<sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>Presence<sp/>|</highlight></codeline>
<codeline lineno="199"><highlight class="comment">------------+<sp/><sp/><sp/><sp/><sp/><sp/><sp/>+------+<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+-----------</highlight></codeline>
<codeline lineno="200"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="201"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="202"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/>|<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="203"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+-------+<sp/><sp/><sp/><sp/><sp/><sp/>+----------+</highlight></codeline>
<codeline lineno="204"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>2<sp/><sp/><sp/><sp/><sp/><sp/>3<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4</highlight></codeline>
<codeline lineno="205"><highlight class="comment"></highlight></codeline>
<codeline lineno="206"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[0].0<sp/><sp/>[0].1<sp/><sp/><sp/><sp/><sp/>[1].0<sp/><sp/><sp/><sp/>[1].1</highlight></codeline>
<codeline lineno="207"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>onewire_rmt_check_presence_pulse(rmt_symbol_word_t<sp/>*rmt_symbols,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>symbol_num)</highlight></codeline>
<codeline lineno="209"><highlight class="normal">{</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>ret<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(symbol_num<sp/>&gt;=<sp/>2)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>there<sp/>should<sp/>be<sp/>at<sp/>lease<sp/>2<sp/>symbols(3<sp/>or<sp/>4<sp/>edges)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rmt_symbols[0].level1<sp/>==<sp/>1)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>bus<sp/>is<sp/>high<sp/>before<sp/>reset<sp/>pulse</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rmt_symbols[0].duration1<sp/>&gt;<sp/>ONEWIRE_RESET_PRESENCE_WAIT_DURATION_MIN<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rmt_symbols[1].duration0<sp/>&gt;<sp/>ONEWIRE_RESET_PRESENCE_DURATION_MIN)<sp/>{</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ret<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">//<sp/>bus<sp/>is<sp/>low<sp/>before<sp/>reset<sp/>pulse(first<sp/>pulse<sp/>after<sp/>rmt<sp/>channel<sp/>init)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rmt_symbols[0].duration0<sp/>&gt;<sp/>ONEWIRE_RESET_PRESENCE_WAIT_DURATION_MIN<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rmt_symbols[1].duration1<sp/>&gt;<sp/>ONEWIRE_RESET_PRESENCE_DURATION_MIN)<sp/>{</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ret<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="225"><highlight class="normal">}</highlight></codeline>
<codeline lineno="226"><highlight class="normal"></highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>onewire_rmt_decode_data(rmt_symbol_word_t<sp/>*rmt_symbols,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>symbol_num,<sp/>uint8_t<sp/>*rx_buf,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>rx_buf_size)</highlight></codeline>
<codeline lineno="228"><highlight class="normal">{</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>byte_pos<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>bit_pos<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>symbol_num;<sp/>i<sp/>++)<sp/>{</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rmt_symbols[i].duration0<sp/>&gt;<sp/>ONEWIRE_SLOT_BIT_SAMPLE_TIME)<sp/>{<sp/></highlight><highlight class="comment">//<sp/>0<sp/>bit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rx_buf[byte_pos]<sp/>&amp;=<sp/>~(1<sp/>&lt;&lt;<sp/>bit_pos);<sp/></highlight><highlight class="comment">//<sp/>LSB<sp/>first</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/></highlight><highlight class="comment">//<sp/>1<sp/>bit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rx_buf[byte_pos]<sp/>|=<sp/>1<sp/>&lt;&lt;<sp/>bit_pos;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit_pos<sp/>++;</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bit_pos<sp/>&gt;=<sp/>8)<sp/>{</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit_pos<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>byte_pos<sp/>++;</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(byte_pos<sp/>&gt;=<sp/>rx_buf_size)<sp/>{</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="246"><highlight class="normal">}</highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal">esp_err_t<sp/>onewire_new_bus_rmt(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structonewire__bus__config__t" kindref="compound">onewire_bus_config_t</ref><sp/>*bus_config,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structonewire__bus__rmt__config__t" kindref="compound">onewire_bus_rmt_config_t</ref><sp/>*rmt_config,<sp/>onewire_bus_handle_t<sp/>*ret_bus)</highlight></codeline>
<codeline lineno="249"><highlight class="normal">{</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/>esp_err_t<sp/>ret<sp/>=<sp/>ESP_OK;</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref><sp/>*bus_rmt<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_RETURN_ON_FALSE(bus_config<sp/>&amp;&amp;<sp/>rmt_config<sp/>&amp;&amp;<sp/>ret_bus,<sp/>ESP_ERR_INVALID_ARG,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;invalid<sp/>argument&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/>bus_rmt<sp/>=<sp/>calloc(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref>));</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_RETURN_ON_FALSE(bus_rmt,<sp/>ESP_ERR_NO_MEM,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;no<sp/>mem<sp/>for<sp/>onewire_bus_rmt_obj_t&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>rmt<sp/>bytes<sp/>encoder<sp/>to<sp/>transmit<sp/>1-wire<sp/>commands<sp/>and<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_bytes_encoder_config_t<sp/>bytes_encoder_config<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.bit0<sp/>=<sp/>onewire_bit0_symbol,</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.bit1<sp/>=<sp/>onewire_bit1_symbol,</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.flags.msb_first<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_new_bytes_encoder(&amp;bytes_encoder_config,<sp/>&amp;bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1ab0dd9ba8fccbd283fd2619ed30baef58" kindref="member">tx_bytes_encoder</ref>),</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;create<sp/>bytes<sp/>encoder<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="265"><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>rmt<sp/>copy<sp/>encoder<sp/>to<sp/>transmit<sp/>1-wire<sp/>reset<sp/>pulse<sp/>or<sp/>bits</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_copy_encoder_config_t<sp/>copy_encoder_config<sp/>=<sp/>{};</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_new_copy_encoder(&amp;copy_encoder_config,<sp/>&amp;bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1af4b1182c1201c65760117aa4e91c8c4b" kindref="member">tx_copy_encoder</ref>),</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;create<sp/>copy<sp/>encoder<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="270"><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Note:<sp/>must<sp/>create<sp/>rmt<sp/>rx<sp/>channel<sp/>before<sp/>tx<sp/>channel</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_rx_channel_config_t<sp/>onewire_rx_channel_cfg<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.clk_src<sp/>=<sp/>RMT_CLK_SRC_DEFAULT,</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.resolution_hz<sp/>=<sp/>ONEWIRE_RMT_RESOLUTION_HZ,</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.gpio_num<sp/>=<sp/>bus_config-&gt;<ref refid="structonewire__bus__config__t_1a1eeb7fc5219f943547ecae0ff890a367" kindref="member">bus_gpio_num</ref>,</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.mem_block_symbols<sp/>=<sp/>ONEWIRE_RMT_RX_MEM_BLOCK_SIZE,</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_new_rx_channel(&amp;onewire_rx_channel_cfg,<sp/>&amp;bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a2f8d7d9ee9961d32488437ac13803e97" kindref="member">rx_channel</ref>),</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;create<sp/>rmt<sp/>rx<sp/>channel<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>create<sp/>rmt<sp/>tx<sp/>channel</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_tx_channel_config_t<sp/>onewire_tx_channel_cfg<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.clk_src<sp/>=<sp/>RMT_CLK_SRC_DEFAULT,</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.resolution_hz<sp/>=<sp/>ONEWIRE_RMT_RESOLUTION_HZ,</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.gpio_num<sp/>=<sp/>bus_config-&gt;<ref refid="structonewire__bus__config__t_1a1eeb7fc5219f943547ecae0ff890a367" kindref="member">bus_gpio_num</ref>,</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.mem_block_symbols<sp/>=<sp/>ONEWIRE_RMT_DEFAULT_MEM_BLOCK_SYMBOLS,</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.trans_queue_depth<sp/>=<sp/>ONEWIRE_RMT_DEFAULT_TRANS_QUEUE_SIZE,</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.flags.io_loop_back<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/></highlight><highlight class="comment">//<sp/>make<sp/>tx<sp/>channel<sp/>coexist<sp/>with<sp/>rx<sp/>channel<sp/>on<sp/>the<sp/>same<sp/>gpio<sp/>pin</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.flags.io_od_mode<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>enable<sp/>open-drain<sp/>mode<sp/>for<sp/>1-wire<sp/>bus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_new_tx_channel(&amp;onewire_tx_channel_cfg,<sp/>&amp;bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>),</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;create<sp/>rmt<sp/>tx<sp/>channel<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="293"><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>allocate<sp/>rmt<sp/>rx<sp/>symbol<sp/>buffer,<sp/>one<sp/>RMT<sp/>symbol<sp/>represents<sp/>one<sp/>bit,<sp/>so<sp/>x8</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a9a3b01cc4f904f5f7d98e8876a6ac784" kindref="member">rx_symbols_buf</ref><sp/>=<sp/>malloc(rmt_config-&gt;<ref refid="structonewire__bus__rmt__config__t_1ad8f34eb6bb5033b2626849e9cc7d38b1" kindref="member">max_rx_bytes</ref><sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(rmt_symbol_word_t)<sp/>*<sp/>8);</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_FALSE(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a9a3b01cc4f904f5f7d98e8876a6ac784" kindref="member">rx_symbols_buf</ref>,<sp/>ESP_ERR_NO_MEM,<sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;no<sp/>mem<sp/>to<sp/>store<sp/>received<sp/>RMT<sp/>symbols&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1ae2168be4d710c2edecbf3f91502a6f82" kindref="member">max_rx_bytes</ref><sp/>=<sp/>rmt_config-&gt;<ref refid="structonewire__bus__rmt__config__t_1ad8f34eb6bb5033b2626849e9cc7d38b1" kindref="member">max_rx_bytes</ref>;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"></highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/>bus_rmt-&gt;receive_queue<sp/>=<sp/>xQueueCreate(1,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(rmt_rx_done_event_data_t));</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_FALSE(bus_rmt-&gt;receive_queue,<sp/>ESP_ERR_NO_MEM,<sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;receive<sp/>queue<sp/>creation<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/>bus_rmt-&gt;bus_mutex<sp/>=<sp/>xSemaphoreCreateMutex();</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_FALSE(bus_rmt-&gt;bus_mutex,<sp/>ESP_ERR_NO_MEM,<sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;bus<sp/>mutex<sp/>creation<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>register<sp/>rmt<sp/>rx<sp/>done<sp/>callback</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_rx_event_callbacks_t<sp/>cbs<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.on_recv_done<sp/>=<sp/>onewire_rmt_rx_done_callback</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_rx_register_event_callbacks(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a2f8d7d9ee9961d32488437ac13803e97" kindref="member">rx_channel</ref>,<sp/>&amp;cbs,<sp/>bus_rmt),</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;enable<sp/>rmt<sp/>rx<sp/>channel<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>enable<sp/>rmt<sp/>channels</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_enable(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a2f8d7d9ee9961d32488437ac13803e97" kindref="member">rx_channel</ref>),<sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;enable<sp/>rmt<sp/>rx<sp/>channel<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_enable(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>),<sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;enable<sp/>rmt<sp/>tx<sp/>channel<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>release<sp/>the<sp/>bus<sp/>by<sp/>sending<sp/>a<sp/>special<sp/>RMT<sp/>symbol</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>rmt_symbol_word_t<sp/>release_symbol<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.level0<sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.duration0<sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.level1<sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>.duration1<sp/>=<sp/>0,</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_transmit(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>,<sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1af4b1182c1201c65760117aa4e91c8c4b" kindref="member">tx_copy_encoder</ref>,<sp/>&amp;release_symbol,</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(release_symbol),<sp/>&amp;onewire_rmt_tx_config),<sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;release<sp/>bus<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a070111cd9158e2c0f04daef399273ec7" kindref="member">base</ref>.<ref refid="structonewire__bus__t_1a5ca49c820334b23d01c79e9f1a7ad011" kindref="member">del</ref><sp/>=<sp/>onewire_bus_rmt_del;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a070111cd9158e2c0f04daef399273ec7" kindref="member">base</ref>.<ref refid="structonewire__bus__t_1a550161c28abdf6c7a2982c2180f10afc" kindref="member">reset</ref><sp/>=<sp/>onewire_bus_rmt_reset;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a070111cd9158e2c0f04daef399273ec7" kindref="member">base</ref>.<ref refid="structonewire__bus__t_1a41ec43f6b226c80f9a5b39945af01c14" kindref="member">write_bit</ref><sp/>=<sp/>onewire_bus_rmt_write_bit;</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a070111cd9158e2c0f04daef399273ec7" kindref="member">base</ref>.<ref refid="structonewire__bus__t_1afada884b3d82aeaefe2ec9a03cf9f0e9" kindref="member">write_bytes</ref><sp/>=<sp/>onewire_bus_rmt_write_bytes;</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a070111cd9158e2c0f04daef399273ec7" kindref="member">base</ref>.<ref refid="structonewire__bus__t_1a0f3cd296844f271fa90a53b70fbe4bed" kindref="member">read_bit</ref><sp/>=<sp/>onewire_bus_rmt_read_bit;</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a070111cd9158e2c0f04daef399273ec7" kindref="member">base</ref>.<ref refid="structonewire__bus__t_1a5e264bcb0a9aa05a8a37a9a3911af3eb" kindref="member">read_bytes</ref><sp/>=<sp/>onewire_bus_rmt_read_bytes;</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/>*ret_bus<sp/>=<sp/>&amp;bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a070111cd9158e2c0f04daef399273ec7" kindref="member">base</ref>;</highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight></codeline>
<codeline lineno="336"><highlight class="normal">err:</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bus_rmt)<sp/>{</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>onewire_bus_rmt_destroy(bus_rmt);</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="342"><highlight class="normal">}</highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_destroy(<ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref><sp/>*bus_rmt)</highlight></codeline>
<codeline lineno="345"><highlight class="normal">{</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1ab0dd9ba8fccbd283fd2619ed30baef58" kindref="member">tx_bytes_encoder</ref>)<sp/>{</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rmt_del_encoder(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1ab0dd9ba8fccbd283fd2619ed30baef58" kindref="member">tx_bytes_encoder</ref>);</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1af4b1182c1201c65760117aa4e91c8c4b" kindref="member">tx_copy_encoder</ref>)<sp/>{</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rmt_del_encoder(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1af4b1182c1201c65760117aa4e91c8c4b" kindref="member">tx_copy_encoder</ref>);</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a2f8d7d9ee9961d32488437ac13803e97" kindref="member">rx_channel</ref>)<sp/>{</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rmt_disable(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a2f8d7d9ee9961d32488437ac13803e97" kindref="member">rx_channel</ref>);</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rmt_del_channel(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a2f8d7d9ee9961d32488437ac13803e97" kindref="member">rx_channel</ref>);</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>)<sp/>{</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rmt_disable(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>);</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rmt_del_channel(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>);</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bus_rmt-&gt;receive_queue)<sp/>{</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vQueueDelete(bus_rmt-&gt;receive_queue);</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bus_rmt-&gt;bus_mutex)<sp/>{</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vSemaphoreDelete(bus_rmt-&gt;bus_mutex);</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a9a3b01cc4f904f5f7d98e8876a6ac784" kindref="member">rx_symbols_buf</ref>)<sp/>{</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a9a3b01cc4f904f5f7d98e8876a6ac784" kindref="member">rx_symbols_buf</ref>);</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/>free(bus_rmt);</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ESP_OK;</highlight></codeline>
<codeline lineno="371"><highlight class="normal">}</highlight></codeline>
<codeline lineno="372"><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_del(onewire_bus_handle_t<sp/>bus)</highlight></codeline>
<codeline lineno="374"><highlight class="normal">{</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref><sp/>*bus_rmt<sp/>=<sp/>__containerof(bus,<sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref>,<sp/>base);</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>onewire_bus_rmt_destroy(bus_rmt);</highlight></codeline>
<codeline lineno="377"><highlight class="normal">}</highlight></codeline>
<codeline lineno="378"><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_reset(onewire_bus_handle_t<sp/>bus)</highlight></codeline>
<codeline lineno="380"><highlight class="normal">{</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref><sp/>*bus_rmt<sp/>=<sp/>__containerof(bus,<sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref>,<sp/>base);</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/>esp_err_t<sp/>ret<sp/>=<sp/>ESP_OK;</highlight></codeline>
<codeline lineno="383"><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/>xSemaphoreTake(bus_rmt-&gt;bus_mutex,<sp/>portMAX_DELAY);</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>send<sp/>reset<sp/>pulse<sp/>while<sp/>receive<sp/>presence<sp/>pulse</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_receive(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a2f8d7d9ee9961d32488437ac13803e97" kindref="member">rx_channel</ref>,<sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a9a3b01cc4f904f5f7d98e8876a6ac784" kindref="member">rx_symbols_buf</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(rmt_symbol_word_t)<sp/>*<sp/>2,<sp/>&amp;onewire_rmt_rx_config),</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;1-wire<sp/>reset<sp/>pulse<sp/>receive<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_transmit(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>,<sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1af4b1182c1201c65760117aa4e91c8c4b" kindref="member">tx_copy_encoder</ref>,<sp/>&amp;onewire_reset_pulse_symbol,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(onewire_reset_pulse_symbol),<sp/>&amp;onewire_rmt_tx_config),</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;1-wire<sp/>reset<sp/>pulse<sp/>transmit<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="390"><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>wait<sp/>and<sp/>check<sp/>presence<sp/>pulse</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_rx_done_event_data_t<sp/>rmt_rx_evt_data;</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_FALSE(xQueueReceive(bus_rmt-&gt;receive_queue,<sp/>&amp;rmt_rx_evt_data,<sp/>pdMS_TO_TICKS(1000))<sp/>==<sp/>pdPASS,</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ESP_ERR_TIMEOUT,<sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;1-wire<sp/>reset<sp/>pulse<sp/>receive<sp/>timeout&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(onewire_rmt_check_presence_pulse(rmt_rx_evt_data.received_symbols,<sp/>rmt_rx_evt_data.num_symbols)<sp/>==<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ret<sp/>=<sp/>ESP_ERR_NOT_FOUND;</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="398"><highlight class="normal"></highlight></codeline>
<codeline lineno="399"><highlight class="normal">err:</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/>xSemaphoreGive(bus_rmt-&gt;bus_mutex);</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="402"><highlight class="normal">}</highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_write_bytes(onewire_bus_handle_t<sp/>bus,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*tx_data,<sp/>uint8_t<sp/>tx_data_size)</highlight></codeline>
<codeline lineno="405"><highlight class="normal">{</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref><sp/>*bus_rmt<sp/>=<sp/>__containerof(bus,<sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref>,<sp/>base);</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/>esp_err_t<sp/>ret<sp/>=<sp/>ESP_OK;</highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/>xSemaphoreTake(bus_rmt-&gt;bus_mutex,<sp/>portMAX_DELAY);</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>transmit<sp/>data<sp/>with<sp/>the<sp/>bytes<sp/>encoder</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_transmit(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>,<sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1ab0dd9ba8fccbd283fd2619ed30baef58" kindref="member">tx_bytes_encoder</ref>,<sp/>tx_data,<sp/>tx_data_size,<sp/>&amp;onewire_rmt_tx_config),</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;1-wire<sp/>data<sp/>transmit<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>wait<sp/>the<sp/>transmission<sp/>to<sp/>complete</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_tx_wait_all_done(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>,<sp/>50),<sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;wait<sp/>for<sp/>1-wire<sp/>data<sp/>transmit<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"></highlight></codeline>
<codeline lineno="416"><highlight class="normal">err:</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/>xSemaphoreGive(bus_rmt-&gt;bus_mutex);</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="419"><highlight class="normal">}</highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"></highlight><highlight class="comment">//<sp/>While<sp/>receiving<sp/>data,<sp/>we<sp/>use<sp/>rmt<sp/>transmit<sp/>channel<sp/>to<sp/>send<sp/>0xFF<sp/>to<sp/>generate<sp/>read<sp/>pulse,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"></highlight><highlight class="comment">//<sp/>at<sp/>the<sp/>same<sp/>time,<sp/>receive<sp/>channel<sp/>is<sp/>used<sp/>to<sp/>record<sp/>weather<sp/>the<sp/>bus<sp/>is<sp/>pulled<sp/>down<sp/>by<sp/>device.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_read_bytes(onewire_bus_handle_t<sp/>bus,<sp/>uint8_t<sp/>*rx_buf,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>rx_buf_size)</highlight></codeline>
<codeline lineno="424"><highlight class="normal">{</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref><sp/>*bus_rmt<sp/>=<sp/>__containerof(bus,<sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref>,<sp/>base);</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/>esp_err_t<sp/>ret<sp/>=<sp/>ESP_OK;</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_RETURN_ON_FALSE(rx_buf_size<sp/>&lt;=<sp/>bus_rmt-&gt;max_rx_bytes,<sp/>ESP_ERR_INVALID_ARG,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;rx_buf_size<sp/>too<sp/>large<sp/>for<sp/>buffer<sp/>to<sp/>hold&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(rx_buf,<sp/>0,<sp/>rx_buf_size);</highlight></codeline>
<codeline lineno="429"><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/>xSemaphoreTake(bus_rmt-&gt;bus_mutex,<sp/>portMAX_DELAY);</highlight></codeline>
<codeline lineno="431"><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>transmit<sp/>one<sp/>bits<sp/>to<sp/>generate<sp/>read<sp/>clock</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>tx_buffer[rx_buf_size];</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/>memset(tx_buffer,<sp/>0xFF,<sp/>rx_buf_size);</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>transmit<sp/>1<sp/>bits<sp/>while<sp/>receiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_receive(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a2f8d7d9ee9961d32488437ac13803e97" kindref="member">rx_channel</ref>,<sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a9a3b01cc4f904f5f7d98e8876a6ac784" kindref="member">rx_symbols_buf</ref>,<sp/>rx_buf_size<sp/>*<sp/>8<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(rmt_symbol_word_t),<sp/>&amp;onewire_rmt_rx_config),</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;1-wire<sp/>data<sp/>receive<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_transmit(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>,<sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1ab0dd9ba8fccbd283fd2619ed30baef58" kindref="member">tx_bytes_encoder</ref>,<sp/>tx_buffer,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(tx_buffer),<sp/>&amp;onewire_rmt_tx_config),</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;1-wire<sp/>data<sp/>transmit<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="440"><highlight class="normal"></highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>wait<sp/>the<sp/>transmission<sp/>finishes<sp/>and<sp/>decode<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_rx_done_event_data_t<sp/>rmt_rx_evt_data;</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_FALSE(xQueueReceive(bus_rmt-&gt;receive_queue,<sp/>&amp;rmt_rx_evt_data,<sp/>pdMS_TO_TICKS(1000))<sp/>==<sp/>pdPASS,<sp/>ESP_ERR_TIMEOUT,</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;1-wire<sp/>data<sp/>receive<sp/>timeout&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/>onewire_rmt_decode_data(rmt_rx_evt_data.received_symbols,<sp/>rmt_rx_evt_data.num_symbols,<sp/>rx_buf,<sp/>rx_buf_size);</highlight></codeline>
<codeline lineno="446"><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal">err:</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/>xSemaphoreGive(bus_rmt-&gt;bus_mutex);</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="450"><highlight class="normal">}</highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_write_bit(onewire_bus_handle_t<sp/>bus,<sp/>uint8_t<sp/>tx_bit)</highlight></codeline>
<codeline lineno="453"><highlight class="normal">{</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref><sp/>*bus_rmt<sp/>=<sp/>__containerof(bus,<sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref>,<sp/>base);</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>rmt_symbol_word_t<sp/>*symbol_to_transmit<sp/>=<sp/>tx_bit<sp/>?<sp/>&amp;onewire_bit1_symbol<sp/>:<sp/>&amp;onewire_bit0_symbol;</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/>esp_err_t<sp/>ret<sp/>=<sp/>ESP_OK;</highlight></codeline>
<codeline lineno="457"><highlight class="normal"></highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/>xSemaphoreTake(bus_rmt-&gt;bus_mutex,<sp/>portMAX_DELAY);</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>transmit<sp/>bit</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_transmit(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>,<sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1af4b1182c1201c65760117aa4e91c8c4b" kindref="member">tx_copy_encoder</ref>,<sp/>symbol_to_transmit,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(rmt_symbol_word_t),<sp/>&amp;onewire_rmt_tx_config),</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;1-wire<sp/>bit<sp/>transmit<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>wait<sp/>the<sp/>transmission<sp/>to<sp/>complete</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_tx_wait_all_done(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>,<sp/>50),<sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;wait<sp/>for<sp/>1-wire<sp/>bit<sp/>transmit<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="465"><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal">err:</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/>xSemaphoreGive(bus_rmt-&gt;bus_mutex);</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="469"><highlight class="normal">}</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>esp_err_t<sp/>onewire_bus_rmt_read_bit(onewire_bus_handle_t<sp/>bus,<sp/>uint8_t<sp/>*rx_bit)</highlight></codeline>
<codeline lineno="472"><highlight class="normal">{</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref><sp/>*bus_rmt<sp/>=<sp/>__containerof(bus,<sp/><ref refid="structonewire__bus__rmt__obj__t" kindref="compound">onewire_bus_rmt_obj_t</ref>,<sp/>base);</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/>esp_err_t<sp/>ret<sp/>=<sp/>ESP_OK;</highlight></codeline>
<codeline lineno="475"><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/>xSemaphoreTake(bus_rmt-&gt;bus_mutex,<sp/>portMAX_DELAY);</highlight></codeline>
<codeline lineno="477"><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>transmit<sp/>1<sp/>bit<sp/>while<sp/>receiving</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_receive(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a2f8d7d9ee9961d32488437ac13803e97" kindref="member">rx_channel</ref>,<sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a9a3b01cc4f904f5f7d98e8876a6ac784" kindref="member">rx_symbols_buf</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(rmt_symbol_word_t),<sp/>&amp;onewire_rmt_rx_config),</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;1-wire<sp/>bit<sp/>receive<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_ERROR(rmt_transmit(bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1a5e20c8f274fa348357a0ecad7a64b230" kindref="member">tx_channel</ref>,<sp/>bus_rmt-&gt;<ref refid="structonewire__bus__rmt__obj__t_1af4b1182c1201c65760117aa4e91c8c4b" kindref="member">tx_copy_encoder</ref>,<sp/>&amp;onewire_bit1_symbol,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(rmt_symbol_word_t),<sp/>&amp;onewire_rmt_tx_config),</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;1-wire<sp/>bit<sp/>transmit<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="483"><highlight class="normal"></highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>wait<sp/>the<sp/>transmission<sp/>finishes<sp/>and<sp/>decode<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/>rmt_rx_done_event_data_t<sp/>rmt_rx_evt_data;</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/>ESP_GOTO_ON_FALSE(xQueueReceive(bus_rmt-&gt;receive_queue,<sp/>&amp;rmt_rx_evt_data,<sp/>pdMS_TO_TICKS(1000))<sp/>==<sp/>pdPASS,<sp/>ESP_ERR_TIMEOUT,</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>err,<sp/>TAG,<sp/></highlight><highlight class="stringliteral">&quot;1-wire<sp/>bit<sp/>receive<sp/>timeout&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>rx_buffer<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/>onewire_rmt_decode_data(rmt_rx_evt_data.received_symbols,<sp/>rmt_rx_evt_data.num_symbols,<sp/>&amp;rx_buffer,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(rx_buffer));</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/>*rx_bit<sp/>=<sp/>rx_buffer<sp/>&amp;<sp/>0x01;</highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal">err:</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/>xSemaphoreGive(bus_rmt-&gt;bus_mutex);</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ret;</highlight></codeline>
<codeline lineno="495"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="components/peripherals/owb/onewire_bus/src/onewire_bus_impl_rmt.c"/>
  </compounddef>
</doxygen>
