\doxysection{components/peripherals/i2c/esp\+\_\+bh1750/bh1750.c File Reference}
\hypertarget{bh1750_8c}{}\label{bh1750_8c}\index{components/peripherals/i2c/esp\_bh1750/bh1750.c@{components/peripherals/i2c/esp\_bh1750/bh1750.c}}
{\ttfamily \#include "{}include/bh1750.\+h"{}}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$esp\+\_\+log.\+h$>$}\newline
{\ttfamily \#include $<$esp\+\_\+check.\+h$>$}\newline
{\ttfamily \#include $<$freertos/\+Free\+RTOS.\+h$>$}\newline
{\ttfamily \#include $<$freertos/task.\+h$>$}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{bh1750_8c_a829a6988a4de1fd531f3417432a67cc5}{BH1750\+\_\+\+OPCODE\+\_\+\+MT\+\_\+\+HI}}~UINT8\+\_\+C(0x40)
\item 
\#define \mbox{\hyperlink{bh1750_8c_ad2f5d03758acabdf071a96e9f1a2cf5e}{BH1750\+\_\+\+OPCODE\+\_\+\+MT\+\_\+\+LO}}~UINT8\+\_\+C(0x60)
\item 
\Hypertarget{bh1750_8c_aa320927f81315a0ba9551eba27acd636}\label{bh1750_8c_aa320927f81315a0ba9551eba27acd636} 
\#define {\bfseries BH1750\+\_\+\+CMD\+\_\+\+POWER\+\_\+\+DOWN}~UINT8\+\_\+C(0b00000000)
\item 
\Hypertarget{bh1750_8c_a959b4a504ca1b3a19451ae1ecdd00c62}\label{bh1750_8c_a959b4a504ca1b3a19451ae1ecdd00c62} 
\#define {\bfseries BH1750\+\_\+\+CMD\+\_\+\+POWER\+\_\+\+UP}~UINT8\+\_\+C(0b00000001)
\item 
\Hypertarget{bh1750_8c_acaf6541bf87e67537302fddb1cc823d8}\label{bh1750_8c_acaf6541bf87e67537302fddb1cc823d8} 
\#define {\bfseries BH1750\+\_\+\+CMD\+\_\+\+RESET}~UINT8\+\_\+C(0b00000111)
\item 
\Hypertarget{bh1750_8c_a3f79540a678337f54378bb90cd04ffc4}\label{bh1750_8c_a3f79540a678337f54378bb90cd04ffc4} 
\#define {\bfseries BH1750\+\_\+\+POWERUP\+\_\+\+DELAY\+\_\+\+MS}~UINT16\+\_\+C(10)
\item 
\Hypertarget{bh1750_8c_aa207fdacf54803072cf1ea2dee554845}\label{bh1750_8c_aa207fdacf54803072cf1ea2dee554845} 
\#define {\bfseries BH1750\+\_\+\+APPSTART\+\_\+\+DELAY\+\_\+\+MS}~UINT16\+\_\+C(10)
\item 
\Hypertarget{bh1750_8c_a2d30c1eba7c16070679653984ee0916e}\label{bh1750_8c_a2d30c1eba7c16070679653984ee0916e} 
\#define {\bfseries BH1750\+\_\+\+RESET\+\_\+\+DELAY\+\_\+\+MS}~UINT16\+\_\+C(25)
\item 
\Hypertarget{bh1750_8c_a8f0ba638f91369313a01072f4072ca1d}\label{bh1750_8c_a8f0ba638f91369313a01072f4072ca1d} 
\#define {\bfseries BH1750\+\_\+\+CMD\+\_\+\+DELAY\+\_\+\+MS}~UINT16\+\_\+C(5)
\item 
\#define \mbox{\hyperlink{bh1750_8c_a13d93db46ea4bdc2883569aae1f859ea}{BH1750\+\_\+\+RETRY\+\_\+\+DELAY\+\_\+\+MS}}~UINT16\+\_\+C(2)
\item 
\#define \mbox{\hyperlink{bh1750_8c_a8fa8c151b2884212b6ed54211745e819}{BH1750\+\_\+\+TX\+\_\+\+RX\+\_\+\+DELAY\+\_\+\+MS}}~UINT16\+\_\+C(10)
\item 
\#define \mbox{\hyperlink{bh1750_8c_ac2bb3db0b37c9f45103fd513ca5158fe}{ESP\+\_\+\+ARG\+\_\+\+CHECK}}(VAL)
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{group__drivers_ga7e476a2704b4a58413b2a7de316ef29d}{bh1750\+\_\+init}} (i2c\+\_\+master\+\_\+bus\+\_\+handle\+\_\+t master\+\_\+handle, const \mbox{\hyperlink{group__drivers_ga473a8d2e67b27ec75271fdda3b84dbba}{bh1750\+\_\+config\+\_\+t}} \texorpdfstring{$\ast$}{*}bh1750\+\_\+config, \mbox{\hyperlink{group__drivers_gaf7d20c4f1eb201955b708b4d81779200}{bh1750\+\_\+handle\+\_\+t}} \texorpdfstring{$\ast$}{*}bh1750\+\_\+handle)
\begin{DoxyCompactList}\small\item\em initializes an BH1750 device onto the I2C master bus. \end{DoxyCompactList}\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{group__drivers_gac577dd8a77cf737c5ef25add84188e01}{bh1750\+\_\+get\+\_\+ambient\+\_\+light}} (\mbox{\hyperlink{group__drivers_gaf7d20c4f1eb201955b708b4d81779200}{bh1750\+\_\+handle\+\_\+t}} handle, float \texorpdfstring{$\ast$}{*}const ambient\+\_\+light)
\begin{DoxyCompactList}\small\item\em measure BH1750 illuminance. BH1750 goes into power-\/down mode after measurement when one-\/time measurements are configured. \end{DoxyCompactList}\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{group__drivers_ga2d4689f3f1c8bbc70b719b38f009c3ac}{bh1750\+\_\+set\+\_\+measurement\+\_\+mode}} (\mbox{\hyperlink{group__drivers_gaf7d20c4f1eb201955b708b4d81779200}{bh1750\+\_\+handle\+\_\+t}} handle, const \mbox{\hyperlink{group__drivers_ga76514573edf401f3839df07163bff37a}{bh1750\+\_\+measurement\+\_\+modes\+\_\+t}} mode)
\begin{DoxyCompactList}\small\item\em Writes measurement mode to bh1750. \end{DoxyCompactList}\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{group__drivers_ga4649a73b0eb65849d3e8b2d53d0e586f}{bh1750\+\_\+set\+\_\+measurement\+\_\+time}} (\mbox{\hyperlink{group__drivers_gaf7d20c4f1eb201955b708b4d81779200}{bh1750\+\_\+handle\+\_\+t}} handle, const uint8\+\_\+t timespan)
\begin{DoxyCompactList}\small\item\em sets bh1750 sensor measurement time. see datasheet for details. \end{DoxyCompactList}\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{group__drivers_gaed00b37e5bfd7819e2c81ef02a04268b}{bh1750\+\_\+enable\+\_\+power}} (\mbox{\hyperlink{group__drivers_gaf7d20c4f1eb201955b708b4d81779200}{bh1750\+\_\+handle\+\_\+t}} handle)
\begin{DoxyCompactList}\small\item\em power-\/up BH1750 sensor. \end{DoxyCompactList}\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{group__drivers_ga1abd1351a7490b7dccc38ba2bc42dce2}{bh1750\+\_\+disable\+\_\+power}} (\mbox{\hyperlink{group__drivers_gaf7d20c4f1eb201955b708b4d81779200}{bh1750\+\_\+handle\+\_\+t}} handle)
\begin{DoxyCompactList}\small\item\em power-\/down BH1750 sensor. \end{DoxyCompactList}\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{group__drivers_ga814dc723c84984e588504cab4a1b2552}{bh1750\+\_\+reset}} (\mbox{\hyperlink{group__drivers_gaf7d20c4f1eb201955b708b4d81779200}{bh1750\+\_\+handle\+\_\+t}} handle)
\begin{DoxyCompactList}\small\item\em soft-\/reset BH1750 sensor. Reset command is not acceptable in power-\/down mode. \end{DoxyCompactList}\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{group__drivers_gadbed4b29cd5936e8df6767c128fa640f}{bh1750\+\_\+remove}} (\mbox{\hyperlink{group__drivers_gaf7d20c4f1eb201955b708b4d81779200}{bh1750\+\_\+handle\+\_\+t}} handle)
\begin{DoxyCompactList}\small\item\em removes an BH1750 device from master bus. \end{DoxyCompactList}\item 
esp\+\_\+err\+\_\+t \mbox{\hyperlink{group__drivers_ga0922b011c6b1d2ce91933e71ea9158f9}{bh1750\+\_\+delete}} (\mbox{\hyperlink{group__drivers_gaf7d20c4f1eb201955b708b4d81779200}{bh1750\+\_\+handle\+\_\+t}} handle)
\begin{DoxyCompactList}\small\item\em removes an BH1750 device from master bus and frees handle. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
ESP-\/\+IDF driver for BH1750 illuminance sensor.

Ported from esp-\/open-\/rtos

Copyright (c) 2024 Eric Gionet (\href{mailto:gionet.c.eric@gmail.com}{\texttt{ gionet.\+c.\+eric@gmail.\+com}})

MIT Licensed as described in the file LICENSE 

\doxysubsection{Macro Definition Documentation}
\Hypertarget{bh1750_8c_a829a6988a4de1fd531f3417432a67cc5}\index{bh1750.c@{bh1750.c}!BH1750\_OPCODE\_MT\_HI@{BH1750\_OPCODE\_MT\_HI}}
\index{BH1750\_OPCODE\_MT\_HI@{BH1750\_OPCODE\_MT\_HI}!bh1750.c@{bh1750.c}}
\doxysubsubsection{\texorpdfstring{BH1750\_OPCODE\_MT\_HI}{BH1750\_OPCODE\_MT\_HI}}
{\footnotesize\ttfamily \label{bh1750_8c_a829a6988a4de1fd531f3417432a67cc5} 
\#define BH1750\+\_\+\+OPCODE\+\_\+\+MT\+\_\+\+HI~UINT8\+\_\+C(0x40)}

measurement time hi-\/bit \Hypertarget{bh1750_8c_ad2f5d03758acabdf071a96e9f1a2cf5e}\index{bh1750.c@{bh1750.c}!BH1750\_OPCODE\_MT\_LO@{BH1750\_OPCODE\_MT\_LO}}
\index{BH1750\_OPCODE\_MT\_LO@{BH1750\_OPCODE\_MT\_LO}!bh1750.c@{bh1750.c}}
\doxysubsubsection{\texorpdfstring{BH1750\_OPCODE\_MT\_LO}{BH1750\_OPCODE\_MT\_LO}}
{\footnotesize\ttfamily \label{bh1750_8c_ad2f5d03758acabdf071a96e9f1a2cf5e} 
\#define BH1750\+\_\+\+OPCODE\+\_\+\+MT\+\_\+\+LO~UINT8\+\_\+C(0x60)}

measurement time lo-\/bit \Hypertarget{bh1750_8c_a13d93db46ea4bdc2883569aae1f859ea}\index{bh1750.c@{bh1750.c}!BH1750\_RETRY\_DELAY\_MS@{BH1750\_RETRY\_DELAY\_MS}}
\index{BH1750\_RETRY\_DELAY\_MS@{BH1750\_RETRY\_DELAY\_MS}!bh1750.c@{bh1750.c}}
\doxysubsubsection{\texorpdfstring{BH1750\_RETRY\_DELAY\_MS}{BH1750\_RETRY\_DELAY\_MS}}
{\footnotesize\ttfamily \label{bh1750_8c_a13d93db46ea4bdc2883569aae1f859ea} 
\#define BH1750\+\_\+\+RETRY\+\_\+\+DELAY\+\_\+\+MS~UINT16\+\_\+C(2)}

bh1750 delay between an I2C receive transaction retry \Hypertarget{bh1750_8c_a8fa8c151b2884212b6ed54211745e819}\index{bh1750.c@{bh1750.c}!BH1750\_TX\_RX\_DELAY\_MS@{BH1750\_TX\_RX\_DELAY\_MS}}
\index{BH1750\_TX\_RX\_DELAY\_MS@{BH1750\_TX\_RX\_DELAY\_MS}!bh1750.c@{bh1750.c}}
\doxysubsubsection{\texorpdfstring{BH1750\_TX\_RX\_DELAY\_MS}{BH1750\_TX\_RX\_DELAY\_MS}}
{\footnotesize\ttfamily \label{bh1750_8c_a8fa8c151b2884212b6ed54211745e819} 
\#define BH1750\+\_\+\+TX\+\_\+\+RX\+\_\+\+DELAY\+\_\+\+MS~UINT16\+\_\+C(10)}

bh1750 delay after attempting an I2C transmit transaction and attempting an I2C receive transaction \Hypertarget{bh1750_8c_ac2bb3db0b37c9f45103fd513ca5158fe}\index{bh1750.c@{bh1750.c}!ESP\_ARG\_CHECK@{ESP\_ARG\_CHECK}}
\index{ESP\_ARG\_CHECK@{ESP\_ARG\_CHECK}!bh1750.c@{bh1750.c}}
\doxysubsubsection{\texorpdfstring{ESP\_ARG\_CHECK}{ESP\_ARG\_CHECK}}
{\footnotesize\ttfamily \label{bh1750_8c_ac2bb3db0b37c9f45103fd513ca5158fe} 
\#define ESP\+\_\+\+ARG\+\_\+\+CHECK(\begin{DoxyParamCaption}\item[{}]{VAL}{}\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordflow}{do}\ \{\ \textcolor{keywordflow}{if}\ (!(VAL))\ \textcolor{keywordflow}{return}\ ESP\_ERR\_INVALID\_ARG;\ \}\ \textcolor{keywordflow}{while}\ (0)}

\end{DoxyCode}
