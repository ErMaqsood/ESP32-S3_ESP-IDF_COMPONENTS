\doxysection{components/peripherals/i2c/esp\+\_\+ltr390uv Directory Reference}
\hypertarget{dir_c7a310725a3059d9520d59a5eaeb8f89}{}\label{dir_c7a310725a3059d9520d59a5eaeb8f89}\index{components/peripherals/i2c/esp\_ltr390uv Directory Reference@{components/peripherals/i2c/esp\_ltr390uv Directory Reference}}
\doxysubsubsection*{Directories}
\begin{DoxyCompactItemize}
\item 
directory \mbox{\hyperlink{dir_5005feec7bb978ef2fbd309c537d30c0}{include}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \mbox{\hyperlink{ltr390uv_8c}{ltr390uv.\+c}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\href{https://github.com/K0I05}{\texttt{ }} \href{/LICENSE}{\texttt{ }} \href{https://en.wikipedia.org/wiki/C_(programming_language)}{\texttt{ }} \href{https://docs.espressif.com/projects/esp-idf/en/stable/esp32/index.html}{\texttt{ }} \href{https://code.visualstudio.com/}{\texttt{ }} \href{https://platformio.org/}{\texttt{ }} \href{https://registry.platformio.org/libraries/k0i05/esp_ltr390uv}{\texttt{ }} \href{https://components.espressif.com/components/k0i05/esp_ltr390uv}{\texttt{ }}

This ESP32 espressif IoT development framework (esp-\/idf) i2c peripheral driver was developed for the Lite-\/\+On LTR390\+UV I2C sensor. Information on features and functionality are documented and can be found in the {\ttfamily \doxylink{ltr390uv_8h}{ltr390uv.\+h}} header file and in the {\ttfamily documentation} folder.\hypertarget{README.md_autotoc_md58}{}\doxysubsection{\texorpdfstring{Repository}{Repository}}\label{README.md_autotoc_md58}
The component is hosted on github and is located here\+: \href{https://github.com/K0I05/ESP32-S3_ESP-IDF_COMPONENTS/tree/main/components/peripherals/i2c/esp_ltr390uv}{\texttt{ https\+://github.\+com/\+K0\+I05/\+ESP32-\/\+S3\+\_\+\+ESP-\/\+IDF\+\_\+\+COMPONENTS/tree/main/components/peripherals/i2c/esp\+\_\+ltr390uv}}\hypertarget{README.md_autotoc_md59}{}\doxysubsection{\texorpdfstring{General Usage}{General Usage}}\label{README.md_autotoc_md59}
To get started, simply copy the component to your project\textquotesingle{}s {\ttfamily components} folder and reference the {\ttfamily \doxylink{ltr390uv_8h}{ltr390uv.\+h}} header file as an include. The component includes documentation for the peripheral such as the datasheet, application notes, and/or user manual where applicable.


\begin{DoxyCode}{0}
\DoxyCodeLine{components}
\DoxyCodeLine{└──\ esp\_ltr390uv}
\DoxyCodeLine{\ \ \ \ ├──\ CMakeLists.txt}
\DoxyCodeLine{\ \ \ \ ├──\ README.md}
\DoxyCodeLine{\ \ \ \ ├──\ LICENSE}
\DoxyCodeLine{\ \ \ \ ├──\ idf\_component.yml}
\DoxyCodeLine{\ \ \ \ ├──\ library.json}
\DoxyCodeLine{\ \ \ \ ├──\ documentation}
\DoxyCodeLine{\ \ \ \ │\ \ \ └──\ datasheets,\ etc.}
\DoxyCodeLine{\ \ \ \ ├──\ include}
\DoxyCodeLine{\ \ \ \ │\ \ \ └──\ ltr390uv\_version.h}
\DoxyCodeLine{\ \ \ \ │\ \ \ └──\ ltr390uv.h}
\DoxyCodeLine{\ \ \ \ └──\ ltr390uv.c}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md60}{}\doxysubsection{\texorpdfstring{Basic Example}{Basic Example}}\label{README.md_autotoc_md60}
Once a driver instance is instantiated the sensor is ready for usage as shown in the below example. This basic implementation of the driver utilizes default configuration settings and makes a measurement request from the sensor at user defined interval and prints the results.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ltr390uv_8h}{ltr390uv.h}}>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void}\ i2c0\_ltr390uv\_task(\ \textcolor{keywordtype}{void}\ *pvParameters\ )\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ initialize\ the\ xLastWakeTime\ variable\ with\ the\ current\ time.}}
\DoxyCodeLine{\ \ \ \ TickType\_t\ \ \ \ \ \ \ \ \ last\_wake\_time\ \ \ =\ xTaskGetTickCount\ ();}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ initialize\ i2c\ device\ configuration}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_gaf416c36c716812bdd1e7270f706cb3b9}{ltr390uv\_config\_t}}\ dev\_cfg\ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{group__drivers_gafa996d8535caa255cd9ca6bb3bd1e6f4}{I2C\_LTR390UV\_CONFIG\_DEFAULT}};}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_ga4360ca0586c82540265c60066087511e}{ltr390uv\_handle\_t}}\ dev\_hdl;}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ init\ device}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_gaca0f1260d725e30226bd641e95c5380d}{ltr390uv\_init}}(i2c0\_bus\_hdl,\ \&dev\_cfg,\ \&dev\_hdl);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}\ (dev\_hdl\ ==\ NULL)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ESP\_LOGE(APP\_TAG,\ \textcolor{stringliteral}{"{}ltr390uv\ handle\ init\ failed"{}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ assert(dev\_hdl);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ ltr390uv\_control\_register\_t\ c\_reg;}
\DoxyCodeLine{\ \ \ \ ltr390uv\_interrupt\_config\_register\_t\ ic\_reg;}
\DoxyCodeLine{\ \ \ \ ltr390uv\_measure\_register\_t\ m\_reg;}
\DoxyCodeLine{\ \ \ \ ltr390uv\_gain\_register\_t\ \ \ \ g\_reg;}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{/*\ attempt\ i2c\ read\ transaction\ */}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_gacc958f4ef325bd874f9702ca6c893cdb}{ltr390uv\_get\_measure\_register}}(dev\_hdl,\ \&m\_reg);}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_ga5c593c30d2be1fcdc4b0193b18efddd5}{ltr390uv\_get\_gain\_register}}(dev\_hdl,\ \&g\_reg);}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_ga10311c032bccc9a49abc6f049fe3464d}{ltr390uv\_get\_interrupt\_config\_register}}(dev\_hdl,\ \&ic\_reg);}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_gad612f2f8f8c797f9d002b6e3dc8a54dd}{ltr390uv\_get\_control\_register}}(dev\_hdl,\ \&c\_reg);}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}Control\ Register\ (0x\%02x):\ \%s"{}},\ c\_reg.reg,\ \mbox{\hyperlink{group__utilities_gad5099995b3a7cf28d0daa6a503b98645}{uint8\_to\_binary}}(c\_reg.reg));}
\DoxyCodeLine{\ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}Measure\ Register\ (0x\%02x):\ \%s"{}},\ m\_reg.reg,\ \mbox{\hyperlink{group__utilities_gad5099995b3a7cf28d0daa6a503b98645}{uint8\_to\_binary}}(m\_reg.reg));}
\DoxyCodeLine{\ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}Gain\ Register\ \ \ \ (0x\%02x):\ \%s"{}},\ g\_reg.reg,\ \mbox{\hyperlink{group__utilities_gad5099995b3a7cf28d0daa6a503b98645}{uint8\_to\_binary}}(g\_reg.reg));}
\DoxyCodeLine{\ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}IRQ\ Cfg\ Register\ (0x\%02x):\ \%s"{}},\ ic\_reg.reg,\ \mbox{\hyperlink{group__utilities_gad5099995b3a7cf28d0daa6a503b98645}{uint8\_to\_binary}}(ic\_reg.reg));}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ task\ loop\ entry\ point}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\ ;;\ )\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\ LTR390UV\ -\/\ START\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#"{}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ handle\ sensor}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ ambient\_light;\ }
\DoxyCodeLine{\ \ \ \ \ \ \ \ esp\_err\_t\ result\ =\ \mbox{\hyperlink{group__drivers_ga6be0f845cc58c39af3a5dc8b72d0e9c9}{ltr390uv\_get\_ambient\_light}}(dev\_hdl,\ \&ambient\_light);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(result\ !=\ ESP\_OK)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGE(APP\_TAG,\ \textcolor{stringliteral}{"{}ltr390uv\ device\ read\ failed\ (\%s)"{}},\ esp\_err\_to\_name(result));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}ambient\ light:\ \ \ \ \ \%.2f\ Lux"{}},\ ambient\_light);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ uint32\_t\ sensor\_counts;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ result\ =\ \mbox{\hyperlink{group__drivers_ga4b7c910399e3431019b597fd0d45cf30}{ltr390uv\_get\_als}}(dev\_hdl,\ \&sensor\_counts);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(result\ !=\ ESP\_OK)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGE(APP\_TAG,\ \textcolor{stringliteral}{"{}ltr390uv\ device\ read\ failed\ (\%s)"{}},\ esp\_err\_to\_name(result));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}als\ sensor\ counts:\ \%lu"{}},\ sensor\_counts);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ uvi;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ result\ =\ \mbox{\hyperlink{group__drivers_ga37cfe17d6ce9b51cef382487f7503591}{ltr390uv\_get\_ultraviolet\_index}}(dev\_hdl,\ \&uvi);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(result\ !=\ ESP\_OK)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGE(APP\_TAG,\ \textcolor{stringliteral}{"{}ltr390uv\ device\ read\ failed\ (\%s)"{}},\ esp\_err\_to\_name(result));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}ultraviolet\ index:\ \%f"{}},\ uvi);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ result\ =\ \mbox{\hyperlink{group__drivers_ga3e70b7975863bf9a5e294cc490b1d37e}{ltr390uv\_get\_uvs}}(dev\_hdl,\ \&sensor\_counts);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(result\ !=\ ESP\_OK)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGE(APP\_TAG,\ \textcolor{stringliteral}{"{}ltr390uv\ device\ read\ failed\ (\%s)"{}},\ esp\_err\_to\_name(result));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}uvs\ sensor\ counts:\ \%lu"{}},\ sensor\_counts);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\ LTR390UV\ -\/\ END\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#"{}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ pause\ the\ task\ per\ defined\ wait\ period}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ vTaskDelaySecUntil(\ \&last\_wake\_time,\ I2C0\_TASK\_SAMPLING\_RATE\ );}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ free\ resources}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_gaad93eb9b72715bcfa3801b3dab58bcab}{ltr390uv\_delete}}(\ dev\_hdl\ );}
\DoxyCodeLine{\ \ \ \ vTaskDelete(\ NULL\ );}
\DoxyCodeLine{\}}

\end{DoxyCode}


Copyright (c) 2024 Eric Gionet (\href{mailto:gionet.c.eric@gmail.com}{\texttt{ gionet.\+c.\+eric@gmail.\+com}}) 