\doxysection{components/peripherals/i2c/esp\+\_\+ens160 Directory Reference}
\hypertarget{dir_ac81e241761d79731505926a858216f7}{}\label{dir_ac81e241761d79731505926a858216f7}\index{components/peripherals/i2c/esp\_ens160 Directory Reference@{components/peripherals/i2c/esp\_ens160 Directory Reference}}
\doxysubsubsection*{Directories}
\begin{DoxyCompactItemize}
\item 
directory \mbox{\hyperlink{dir_5daa2c7212fa02903d0a99f6fafe17ea}{include}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Files}
\begin{DoxyCompactItemize}
\item 
file \mbox{\hyperlink{ens160_8c}{ens160.\+c}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\href{https://github.com/K0I05}{\texttt{ }} \href{/LICENSE}{\texttt{ }} \href{https://en.wikipedia.org/wiki/C_(programming_language)}{\texttt{ }} \href{https://docs.espressif.com/projects/esp-idf/en/stable/esp32/index.html}{\texttt{ }} \href{https://code.visualstudio.com/}{\texttt{ }} \href{https://platformio.org/}{\texttt{ }} \href{https://registry.platformio.org/libraries/k0i05/esp_ens160}{\texttt{ }} \href{https://components.espressif.com/components/k0i05/esp_ens160}{\texttt{ }}

This ESP32 espressif IoT development framework (esp-\/idf) i2c peripheral driver was developed for the Scio\+Sense ENS160 digital metal-\/oxide multi-\/gas sensor. Information on features and functionality are documented and can be found in the {\ttfamily \doxylink{ens160_8h}{ens160.\+h}} header file and in the {\ttfamily documentation} folder.\hypertarget{README.md_autotoc_md42}{}\doxysubsection{\texorpdfstring{Repository}{Repository}}\label{README.md_autotoc_md42}
The component is hosted on github and is located here\+: \href{https://github.com/K0I05/ESP32-S3_ESP-IDF_COMPONENTS/tree/main/components/peripherals/i2c/esp_ens160}{\texttt{ https\+://github.\+com/\+K0\+I05/\+ESP32-\/\+S3\+\_\+\+ESP-\/\+IDF\+\_\+\+COMPONENTS/tree/main/components/peripherals/i2c/esp\+\_\+ens160}}\hypertarget{README.md_autotoc_md43}{}\doxysubsection{\texorpdfstring{General Usage}{General Usage}}\label{README.md_autotoc_md43}
To get started, simply copy the component to your project\textquotesingle{}s {\ttfamily components} folder and reference the {\ttfamily \doxylink{ens160_8h}{ens160.\+h}} header file as an include. The component includes documentation for the peripheral such as the datasheet, application notes, and/or user manual where applicable.


\begin{DoxyCode}{0}
\DoxyCodeLine{components}
\DoxyCodeLine{└──\ esp\_ens160}
\DoxyCodeLine{\ \ \ \ ├──\ CMakeLists.txt}
\DoxyCodeLine{\ \ \ \ ├──\ README.md}
\DoxyCodeLine{\ \ \ \ ├──\ LICENSE}
\DoxyCodeLine{\ \ \ \ ├──\ idf\_component.yml}
\DoxyCodeLine{\ \ \ \ ├──\ library.json}
\DoxyCodeLine{\ \ \ \ ├──\ documentation}
\DoxyCodeLine{\ \ \ \ │\ \ \ └──\ datasheets,\ etc.}
\DoxyCodeLine{\ \ \ \ ├──\ include}
\DoxyCodeLine{\ \ \ \ │\ \ \ └──\ ens160\_version.h}
\DoxyCodeLine{\ \ \ \ │\ \ \ └──\ ens160.h}
\DoxyCodeLine{\ \ \ \ └──\ ens160.c}

\end{DoxyCode}
\hypertarget{README.md_autotoc_md44}{}\doxysubsection{\texorpdfstring{Basic Example}{Basic Example}}\label{README.md_autotoc_md44}
Once a driver instance is instantiated the sensor is ready for usage as shown in the below example. This basic implementation of the driver utilizes default configuration settings and makes a measurement request from the sensor at user defined interval and prints the results.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ens160_8h}{ens160.h}}>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void}\ i2c0\_ens160\_task(\ \textcolor{keywordtype}{void}\ *pvParameters\ )\ \{}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ initialize\ the\ xLastWakeTime\ variable\ with\ the\ current\ time.}}
\DoxyCodeLine{\ \ \ \ TickType\_t\ \ \ \ \ \ \ \ \ \ last\_wake\_time\ \ \ =\ xTaskGetTickCount\ ();}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ initialize\ i2c\ device\ configuration}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_gadcf19e4502c842b6dbc749ed6e19ab96}{ens160\_config\_t}}\ dev\_cfg\ \ \ \ \ \ \ \ \ \ =\ \mbox{\hyperlink{group__drivers_gab6760dc29adf5219230214535464b500}{I2C\_ENS160\_CONFIG\_DEFAULT}};}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_gafdcb747a70da714654218fbcd1d1e2c9}{ens160\_handle\_t}}\ dev\_hdl;}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ init\ device}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_gac139f3a1dd540b59f58adcf7ef5770ad}{ens160\_init}}(i2c0\_bus\_hdl,\ \&dev\_cfg,\ \&dev\_hdl);}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{if}\ (dev\_hdl\ ==\ NULL)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ESP\_LOGE(APP\_TAG,\ \textcolor{stringliteral}{"{}ens160\ handle\ init\ failed"{}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ assert(dev\_hdl);}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ uint16\_t\ startup\_time\ =\ 0;\ \textcolor{comment}{//\ seconds}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ task\ loop\ entry\ point}}
\DoxyCodeLine{\ \ \ \ \textcolor{keywordflow}{for}\ (\ ;;\ )\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\ ENS160\ -\/\ START\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#"{}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ handle\ sensor}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \mbox{\hyperlink{group__drivers_gac81c26d5b704c609e33b6f4ba7057201}{ens160\_validity\_flags\_t}}\ dev\_flag;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{group__drivers_ga159fd485dba74a5fc090875de79ad53f}{ens160\_get\_validity\_status}}(dev\_hdl,\ \&dev\_flag)\ ==\ ESP\_OK)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ validate\ device\ status}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(dev\_flag\ ==\ \mbox{\hyperlink{group__drivers_gga5af0eb865fa92927dfd16523bb653742a26345bcbbdfacd24a06cd0ec33038ae7}{ENS160\_VALFLAG\_NORMAL}})\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__drivers_ga9bf81e9124e5c07b24ebebc2dd141904}{ens160\_air\_quality\_data\_t}}\ aq\_data;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ esp\_err\_t\ result\ =\ \mbox{\hyperlink{group__drivers_ga6b3e7bd873aa221d7fa868356da85bc4}{ens160\_get\_measurement}}(dev\_hdl,\ \&aq\_data);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(result\ !=\ ESP\_OK)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGE(APP\_TAG,\ \textcolor{stringliteral}{"{}ens160\ device\ read\ failed\ (\%s)"{}},\ esp\_err\_to\_name(result));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__drivers_ga160c5dbdb5e259518d2e997c49566e2b}{ens160\_aqi\_uba\_row\_t}}\ uba\_aqi\ =\ \mbox{\hyperlink{group__drivers_ga4d2de4eb0b2febd66f4abd03c3d853ea}{ens160\_aqi\_index\_to\_definition}}(aq\_data.\mbox{\hyperlink{structens160__air__quality__data__s_aa5d3fed2da33a5ecbbfb2204ab5012a7}{uba\_aqi}});}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}index\ \ \ \ \%1x\ (\%s)"{}},\ aq\_data.\mbox{\hyperlink{structens160__air__quality__data__s_aa5d3fed2da33a5ecbbfb2204ab5012a7}{uba\_aqi}},\ uba\_aqi.\mbox{\hyperlink{structens160__aqi__uba__row__s_ad9e3757cd62fe48563a89c5c31340344}{rating}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}tvco\ \ \ \ \ \%d\ (0x\%04x)"{}},\ aq\_data.\mbox{\hyperlink{structens160__air__quality__data__s_a26fd892e05117ff980a779acfac83982}{tvoc}},\ aq\_data.\mbox{\hyperlink{structens160__air__quality__data__s_a26fd892e05117ff980a779acfac83982}{tvoc}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}etoh\ \ \ \ \ \%d\ (0x\%04x)"{}},\ aq\_data.\mbox{\hyperlink{structens160__air__quality__data__s_a7dd62fb3d78b66bd1e649ba2f702811b}{etoh}},\ aq\_data.\mbox{\hyperlink{structens160__air__quality__data__s_a7dd62fb3d78b66bd1e649ba2f702811b}{etoh}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}eco2\ \ \ \ \ \%d\ (0x\%04x)"{}},\ aq\_data.\mbox{\hyperlink{structens160__air__quality__data__s_a6ae8195dcd841d5d5a27361dbe594a5d}{eco2}},\ aq\_data.\mbox{\hyperlink{structens160__air__quality__data__s_a6ae8195dcd841d5d5a27361dbe594a5d}{eco2}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{group__drivers_gaff8f3f610bc3439129f39f314c4e4616}{ens160\_air\_quality\_raw\_data\_t}}\ aq\_raw\_data;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ \mbox{\hyperlink{group__drivers_ga1dd2b9036a23da1e0ca670bb48c70760}{ens160\_get\_raw\_measurement}}(dev\_hdl,\ \&aq\_raw\_data);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(result\ !=\ ESP\_OK)\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGE(APP\_TAG,\ \textcolor{stringliteral}{"{}ens160\ device\ read\ failed\ (\%s)"{}},\ esp\_err\_to\_name(result));}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}ri-\/res\ 0\ \%lu"{}},\ aq\_raw\_data.hp0\_ri);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}ri-\/res\ 1\ \%lu"{}},\ aq\_raw\_data.hp1\_ri);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}ri-\/res\ 2\ \%lu"{}},\ aq\_raw\_data.hp2\_ri);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}ri-\/res\ 3\ \%lu"{}},\ aq\_raw\_data.hp3\_ri);}
\DoxyCodeLine{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}bl-\/res\ 0\ \%lu"{}},\ aq\_raw\_data.hp0\_bl);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}bl-\/res\ 1\ \%lu"{}},\ aq\_raw\_data.hp1\_bl);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}bl-\/res\ 2\ \%lu"{}},\ aq\_raw\_data.hp2\_bl);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}bl-\/res\ 3\ \%lu"{}},\ aq\_raw\_data.hp3\_bl);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(dev\_flag\ ==\ \mbox{\hyperlink{group__drivers_gga5af0eb865fa92927dfd16523bb653742a46de0ca9c1984f11ace5fe5fe7445cc6}{ENS160\_VALFLAG\_WARMUP}})\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}ens160\ device\ is\ warming\ up\ (180-\/sec\ wait\ [\%u-\/sec])"{}},\ startup\_time);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ startup\_time\ =\ startup\_time\ +\ I2C0\_TASK\_SAMPLING\_RATE;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(dev\_flag\ ==\ \mbox{\hyperlink{group__drivers_gga5af0eb865fa92927dfd16523bb653742ae12feb5e210c38c99a621d7856858a4c}{ENS160\_VALFLAG\_INITIAL\_STARTUP}})\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}ens160\ device\ is\ undrgoing\ initial\ starting\ up\ (3600-\/sec\ wait\ [\%u-\/sec])"{}},\ startup\_time);}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ startup\_time\ =\ startup\_time\ +\ I2C0\_TASK\_SAMPLING\_RATE;}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(dev\_flag\ ==\ \mbox{\hyperlink{group__drivers_gga5af0eb865fa92927dfd16523bb653742a5e1a92acf9a54d6aec0d4dbc1fe47193}{ENS160\_VALFLAG\_INVALID\_OUTPUT}})\ \{}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ESP\_LOGW(APP\_TAG,\ \textcolor{stringliteral}{"{}ens160\ device\ signals\ are\ giving\ unexpected\ values"{}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ESP\_LOGI(APP\_TAG,\ \textcolor{stringliteral}{"{}\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\ ENS160\ -\/\ END\ \#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#"{}});}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \textcolor{comment}{//\ pause\ the\ task\ per\ defined\ wait\ period}}
\DoxyCodeLine{\ \ \ \ \ \ \ \ vTaskDelaySecUntil(\ \&last\_wake\_time,\ I2C0\_TASK\_SAMPLING\_RATE\ );}
\DoxyCodeLine{\ \ \ \ \}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\ \ \ \ \textcolor{comment}{//\ free\ resources}}
\DoxyCodeLine{\ \ \ \ \mbox{\hyperlink{group__drivers_ga40c349fa1fce998b90de2a9e14ed701d}{ens160\_delete}}(\ dev\_hdl\ );}
\DoxyCodeLine{\ \ \ \ vTaskDelete(\ NULL\ );}
\DoxyCodeLine{\}}

\end{DoxyCode}


Copyright (c) 2024 Eric Gionet (\href{mailto:gionet.c.eric@gmail.com}{\texttt{ gionet.\+c.\+eric@gmail.\+com}}) 